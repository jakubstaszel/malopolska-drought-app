import pandas as pd
import datetime as dt

from pathlib import Path


def get_stats():
    data = {
        "ndwi1": [
            {"date": "2018-04-20", "mean": 0.33981946, "median": 0.36562002},
            {"date": "2018-06-19", "mean": 0.51009715, "median": 0.54926693},
            {"date": "2018-08-23", "mean": 0.4550537, "median": 0.5367347},
            {"date": "2018-11-06", "mean": 0.34433347, "median": 0.3368352},
            {"date": "2019-03-31", "mean": 0.17856099, "median": 0.13002536},
            {"date": "2019-06-09", "mean": 0.54263836, "median": 0.6086302},
            {"date": "2019-08-28", "mean": 0.46298376, "median": 0.5391452},
            {"date": "2019-10-27", "mean": 0.3414594, "median": 0.35730338},
            {"date": "2020-04-09", "mean": 0.23032409, "median": 0.19837509},
            {"date": "2020-06-13", "mean": 0.55722404, "median": 0.6147496},
            {"date": "2020-08-22", "mean": 0.4589432, "median": 0.5418376},
            {"date": "2020-11-25", "mean": 0.34972128, "median": 0.3358036},
            {"date": "2021-04-09", "mean": 0.23702225, "median": 0.19832677},
            {"date": "2021-06-18", "mean": 0.541423, "median": 0.6134541},
            {"date": "2021-09-06", "mean": 0.51797116, "median": 0.59748125},
            {"date": "2021-10-31", "mean": 0.35035425, "median": 0.36551243},
            {"date": "2022-03-25", "mean": 0.08197028, "median": 0.05378083},
            {"date": "2022-06-03", "mean": 0.36724707, "median": 0.4091067},
            {"date": "2022-08-27", "mean": 0.30272081, "median": 0.3484719},
            {"date": "2022-10-31", "mean": 0.19537546, "median": 0.20937805},
            {"date": "2023-04-23", "mean": 0.20418344, "median": 0.20440252},
            {"date": "2023-06-03", "mean": 0.37474215, "median": 0.41055045},
        ],
        "ndwi2": [
            {"date": "2018-04-20", "mean": -0.5724523, "median": -0.6150519},
            {"date": "2018-06-19", "mean": -0.6124414, "median": -0.63987136},
            {"date": "2018-08-23", "mean": -0.6159029, "median": -0.6681583},
            {"date": "2018-11-06", "mean": -0.5895894, "median": -0.6138614},
            {"date": "2019-03-31", "mean": -0.4909156, "median": -0.5011389},
            {"date": "2019-06-09", "mean": -0.6443439, "median": -0.692548},
            {"date": "2019-08-28", "mean": -0.6064526, "median": -0.6578057},
            {"date": "2019-10-27", "mean": -0.59371305, "median": -0.6348315},
            {"date": "2020-04-09", "mean": -0.5207639, "median": -0.5406434},
            {"date": "2020-06-13", "mean": -0.64754796, "median": -0.68898976},
            {"date": "2020-08-22", "mean": -0.6404886, "median": -0.6982947},
            {"date": "2020-11-25", "mean": -0.55718803, "median": -0.5853033},
            {"date": "2021-04-09", "mean": -0.49504566, "median": -0.5173002},
            {"date": "2021-06-18", "mean": -0.65080106, "median": -0.697831},
            {"date": "2021-09-06", "mean": -0.67845404, "median": -0.7341467},
            {"date": "2021-10-31", "mean": -0.6080543, "median": -0.64820015},
            {"date": "2022-03-25", "mean": -0.26462314, "median": -0.27127925},
            {"date": "2022-06-03", "mean": -0.45036086, "median": -0.47615498},
            {"date": "2022-08-27", "mean": -0.39367136, "median": -0.4159075},
            {"date": "2022-10-31", "mean": -0.30862716, "median": -0.31549543},
            {"date": "2023-04-23", "mean": -0.32770187, "median": -0.32614943},
            {"date": "2023-06-03", "mean": -0.44116688, "median": -0.4653775},
        ],
        "nmdi": [
            {"date": "2018-04-20", "mean": 0.5891289, "median": 0.57601917},
            {"date": "2018-06-19", "mean": 0.5826271, "median": 0.5848165},
            {"date": "2018-08-23", "mean": 0.5683382, "median": 0.5572941},
            {"date": "2018-11-06", "mean": 0.5237994, "median": 0.52886367},
            {"date": "2019-03-31", "mean": 0.5859443, "median": 0.56494844},
            {"date": "2019-06-09", "mean": 0.62532306, "median": 0.61938435},
            {"date": "2019-08-28", "mean": 0.5624115, "median": 0.5552486},
            {"date": "2019-10-27", "mean": 0.54916346, "median": 0.5436869},
            {"date": "2020-04-09", "mean": 0.56827587, "median": 0.5520737},
            {"date": "2020-06-13", "mean": 0.61266327, "median": 0.6074074},
            {"date": "2020-08-22", "mean": 0.5534283, "median": 0.553058},
            {"date": "2020-11-25", "mean": 0.5653453, "median": 0.56823105},
            {"date": "2021-04-09", "mean": 0.6056058, "median": 0.58814186},
            {"date": "2021-06-18", "mean": 0.62687105, "median": 0.62370855},
            {"date": "2021-09-06", "mean": 0.60056955, "median": 0.6030864},
            {"date": "2021-10-31", "mean": 0.54365605, "median": 0.54194504},
            {"date": "2022-03-25", "mean": 0.7210049, "median": 0.70798385},
            {"date": "2022-06-03", "mean": 0.7143844, "median": 0.7040752},
            {"date": "2022-08-27", "mean": 0.65864134, "median": 0.65175676},
            {"date": "2022-10-31", "mean": 0.67864275, "median": 0.6724788},
            {"date": "2023-04-23", "mean": 0.7078064, "median": 0.6967337},
            {"date": "2023-06-03", "mean": 0.7211892, "median": 0.71229696},
        ],
        "ndmi": [
            {"date": "2018-04-20", "mean": 0.125333, "median": 0.13011993},
            {"date": "2018-06-19", "mean": 0.24101293, "median": 0.26769525},
            {"date": "2018-08-23", "mean": 0.18553874, "median": 0.22506812},
            {"date": "2018-11-06", "mean": 0.09495701, "median": 0.081131026},
            {"date": "2019-03-31", "mean": 0.010271054, "median": -0.033327695},
            {"date": "2019-06-09", "mean": 0.29504675, "median": 0.32839033},
            {"date": "2019-08-28", "mean": 0.18533534, "median": 0.22384192},
            {"date": "2019-10-27", "mean": 0.10034113, "median": 0.09351012},
            {"date": "2020-04-09", "mean": 0.043618217, "median": 0.0093847755},
            {"date": "2020-06-13", "mean": 0.29697156, "median": 0.32509804},
            {"date": "2020-08-22", "mean": 0.1843376, "median": 0.23135658},
            {"date": "2020-11-25", "mean": 0.13117433, "median": 0.112251885},
            {"date": "2021-04-09", "mean": 0.06821801, "median": 0.02798756},
            {"date": "2021-06-18", "mean": 0.29527977, "median": 0.33625475},
            {"date": "2021-09-06", "mean": 0.27022305, "median": 0.31625775},
            {"date": "2021-10-31", "mean": 0.1058787, "median": 0.0964023},
            {"date": "2022-03-25", "mean": -0.01280313, "median": -0.04477229},
            {"date": "2022-06-03", "mean": 0.21914533, "median": 0.24418002},
            {"date": "2022-08-27", "mean": 0.12807693, "median": 0.15470624},
            {"date": "2022-10-31", "mean": 0.052187134, "median": 0.050479557},
            {"date": "2023-04-23", "mean": 0.08333682, "median": 0.075208165},
            {"date": "2023-06-03", "mean": 0.23157814, "median": 0.25321352},
        ],
        "ndvi": [
            {"date": "2018-04-20", "mean": 0.596858, "median": 0.65442765},
            {"date": "2018-06-19", "mean": 0.676691, "median": 0.7204087},
            {"date": "2018-08-23", "mean": 0.6656254, "median": 0.75034297},
            {"date": "2018-11-06", "mean": 0.583405, "median": 0.5986949},
            {"date": "2019-03-31", "mean": 0.45343515, "median": 0.44484723},
            {"date": "2019-06-09", "mean": 0.73276234, "median": 0.80838895},
            {"date": "2019-08-28", "mean": 0.6753655, "median": 0.763081},
            {"date": "2019-10-27", "mean": 0.61204165, "median": 0.65742576},
            {"date": "2020-04-09", "mean": 0.48535687, "median": 0.48706412},
            {"date": "2020-06-13", "mean": 0.73866916, "median": 0.80408543},
            {"date": "2020-08-22", "mean": 0.69578874, "median": 0.8006463},
            {"date": "2020-11-25", "mean": 0.54808784, "median": 0.5580196},
            {"date": "2021-04-09", "mean": 0.4559965, "median": 0.46132973},
            {"date": "2021-06-18", "mean": 0.7275348, "median": 0.80601317},
            {"date": "2021-09-06", "mean": 0.74215955, "median": 0.8394509},
            {"date": "2021-10-31", "mean": 0.5871453, "median": 0.6227979},
            {"date": "2022-03-25", "mean": 0.22362901, "median": 0.2179676},
            {"date": "2022-06-03", "mean": 0.4906139, "median": 0.5284286},
            {"date": "2022-08-27", "mean": 0.4193521, "median": 0.453808},
            {"date": "2022-10-31", "mean": 0.30452716, "median": 0.3068515},
            {"date": "2023-04-23", "mean": 0.3359711, "median": 0.33525416},
            {"date": "2023-06-03", "mean": 0.48350674, "median": 0.51914954},
        ],
        "wdrvi": [
            {"date": "2018-04-20", "mean": -0.35038197, "median": -0.35249367},
            {"date": "2018-06-19", "mean": -0.23837142, "median": -0.23813726},
            {"date": "2018-08-23", "mean": -0.22839084, "median": -0.17571059},
            {"date": "2018-11-06", "mean": -0.37751192, "median": -0.43023255},
            {"date": "2019-03-31", "mean": -0.5351013, "median": -0.5869726},
            {"date": "2019-06-09", "mean": -0.09697926, "median": -0.028922454},
            {"date": "2019-08-28", "mean": -0.21140417, "median": -0.14667696},
            {"date": "2019-10-27", "mean": -0.3282609, "median": -0.34787688},
            {"date": "2020-04-09", "mean": -0.49969146, "median": -0.550493},
            {"date": "2020-06-13", "mean": -0.103812985, "median": -0.04120404},
            {"date": "2020-08-22", "mean": -0.13445069, "median": -0.050838556},
            {"date": "2020-11-25", "mean": -0.41597867, "median": -0.47873354},
            {"date": "2021-04-09", "mean": -0.53737, "median": -0.5732118},
            {"date": "2021-06-18", "mean": -0.09754659, "median": -0.03573392},
            {"date": "2021-09-06", "mean": -0.037686348, "median": 0.06791409},
            {"date": "2021-10-31", "mean": -0.34162578, "median": -0.39838648},
            {"date": "2022-03-25", "mean": -0.7234937, "median": -0.73048717},
            {"date": "2022-06-03", "mean": -0.52294326, "median": -0.510444},
            {"date": "2022-08-27", "mean": -0.58980227, "median": -0.57956475},
            {"date": "2022-10-31", "mean": -0.6755477, "median": -0.682739},
            {"date": "2023-04-23", "mean": -0.65224534, "median": -0.6654635},
            {"date": "2023-06-03", "mean": -0.52981025, "median": -0.5198379},
        ],
        "evi": [
            {"date": "2018-04-20", "mean": 1.5308864, "median": 1.627983},
            {"date": "2018-06-19", "mean": 2.213298, "median": 2.2847204},
            {"date": "2018-08-23", "mean": 1.9539961, "median": 2.1732588},
            {"date": "2018-11-06", "mean": 1.2927476, "median": 1.2599964},
            {"date": "2019-03-31", "mean": 1.4347773, "median": 1.2159723},
            {"date": "2019-06-09", "mean": 2.4590187, "median": 2.6820254},
            {"date": "2019-08-28", "mean": 2.5567129, "median": 2.7098587},
            {"date": "2019-10-27", "mean": 1.5931642, "median": 1.5907618},
            {"date": "2020-04-09", "mean": 1.1999536, "median": 1.119403},
            {"date": "2020-06-13", "mean": 2.5667017, "median": 2.7266889},
            {"date": "2020-08-22", "mean": 2.1555903, "median": 2.4255238},
            {"date": "2020-11-25", "mean": 1.2723304, "median": 1.2140257},
            {"date": "2021-04-09", "mean": 1.3219122, "median": 1.1818048},
            {"date": "2021-06-18", "mean": 2.3770247, "median": 2.6400206},
            {"date": "2021-09-06", "mean": 2.2100086, "median": 2.4471734},
            {"date": "2021-10-31", "mean": 1.1895304, "median": 1.1809287},
            {"date": "2022-03-25", "mean": 1.3263481, "median": 0.9684685},
            {"date": "2022-06-03", "mean": 2.7358837, "median": 2.9648833},
            {"date": "2022-08-27", "mean": 2.472137, "median": 2.6578317},
            {"date": "2022-10-31", "mean": 1.8578933, "median": 1.7272727},
            {"date": "2023-04-23", "mean": 2.1296356, "median": 2.127828},
            {"date": "2023-06-03", "mean": 2.57159, "median": 2.7664156},
        ],
        "msavi2": [
            {"date": "2018-04-20", "mean": 0.7236882, "median": 0.7915039},
            {"date": "2018-06-19", "mean": 0.79297024, "median": 0.8376465},
            {"date": "2018-08-23", "mean": 0.77556825, "median": 0.8574219},
            {"date": "2018-11-06", "mean": 0.7194507, "median": 0.7492676},
            {"date": "2019-03-31", "mean": 0.60222155, "median": 0.61608887},
            {"date": "2019-06-09", "mean": 0.82904005, "median": 0.89404297},
            {"date": "2019-08-28", "mean": 0.78264594, "median": 0.86572266},
            {"date": "2019-10-27", "mean": 0.73974454, "median": 0.7937012},
            {"date": "2020-04-09", "mean": 0.63222015, "median": 0.6555176},
            {"date": "2020-06-13", "mean": 0.8350672, "median": 0.89160156},
            {"date": "2020-08-22", "mean": 0.7951305, "median": 0.88964844},
            {"date": "2020-11-25", "mean": 0.68920356, "median": 0.7167969},
            {"date": "2021-04-09", "mean": 0.6077438, "median": 0.63183594},
            {"date": "2021-06-18", "mean": 0.82464015, "median": 0.89282227},
            {"date": "2021-09-06", "mean": 0.83416724, "median": 0.91308594},
            {"date": "2021-10-31", "mean": 0.71885365, "median": 0.76831055},
            {"date": "2022-03-25", "mean": 0.3564861, "median": 0.35791016},
            {"date": "2022-06-03", "mean": 0.6428643, "median": 0.69140625},
            {"date": "2022-08-27", "mean": 0.5751133, "median": 0.6242676},
            {"date": "2022-10-31", "mean": 0.45487002, "median": 0.46948242},
            {"date": "2023-04-23", "mean": 0.48796126, "median": 0.50219727},
            {"date": "2023-06-03", "mean": 0.63656414, "median": 0.68359375},
        ],
        "msi": [
            {"date": "2018-04-20", "mean": 0.78517133, "median": 0.7479452},
            {"date": "2018-06-19", "mean": 0.58852017, "median": 0.53905416},
            {"date": "2018-08-23", "mean": 0.6762141, "median": 0.58623743},
            {"date": "2018-11-06", "mean": 0.8181309, "median": 0.81578946},
            {"date": "2019-03-31", "mean": 1.0045164, "median": 1.0529293},
            {"date": "2019-06-09", "mean": 0.5407261, "median": 0.48165137},
            {"date": "2019-08-28", "mean": 0.6688163, "median": 0.58284456},
            {"date": "2019-10-27", "mean": 0.81398875, "median": 0.7933402},
            {"date": "2020-04-09", "mean": 0.94374675, "median": 0.9731259},
            {"date": "2020-06-13", "mean": 0.53244835, "median": 0.4828418},
            {"date": "2020-08-22", "mean": 0.6841615, "median": 0.58249336},
            {"date": "2020-11-25", "mean": 0.78537893, "median": 0.78896415},
            {"date": "2021-04-09", "mean": 0.9127581, "median": 0.9454938},
            {"date": "2021-06-18", "mean": 0.543801, "median": 0.47325101},
            {"date": "2021-09-06", "mean": 0.59878045, "median": 0.5113857},
            {"date": "2021-10-31", "mean": 0.8106015, "median": 0.79252577},
            {"date": "2022-03-25", "mean": 1.0306852, "median": 1.083006},
            {"date": "2022-06-03", "mean": 0.64774233, "median": 0.5951763},
            {"date": "2022-08-27", "mean": 0.7546071, "median": 0.6897404},
            {"date": "2022-10-31", "mean": 0.87373734, "median": 0.85942584},
            {"date": "2023-04-23", "mean": 0.85036445, "median": 0.84668124},
            {"date": "2023-06-03", "mean": 0.63414586, "median": 0.58831656},
        ],
    }

    for index in data.keys():
        data[index] = pd.DataFrame.from_dict(data[index]).set_index("date")
    return data


def get_means_normalized():
    data = {
        "2018-04-20": {
            "ndwi1": 0.45744943618774414,
            "ndwi2": 0.25614744424819946,
            "nmdi": 0.3309669494628906,
            "ndmi": 0.5540755391120911,
            "ndvi": 0.28021788597106934,
            "wdrvi": 0.45595258474349976,
            "evi": 0.779250979423523,
            "msavi2": 0.23272758722305298,
            "msi": 0.5072346329689026,
        },
        "2018-06-19": {
            "ndwi1": 0.09916150569915771,
            "ndwi2": 0.15951593220233917,
            "nmdi": 0.2980280816555023,
            "ndmi": 0.1806430220603943,
            "ndvi": 0.12625783681869507,
            "wdrvi": 0.2926260232925415,
            "evi": 0.33794713020324707,
            "msavi2": 0.08796203136444092,
            "msi": 0.11254049092531204,
        },
        "2018-08-23": {
            "ndwi1": 0.2149806022644043,
            "ndwi2": 0.15115144848823547,
            "nmdi": 0.22563880681991577,
            "ndmi": 0.3597221374511719,
            "ndvi": 0.14759814739227295,
            "wdrvi": 0.27807295322418213,
            "evi": 0.5056332349777222,
            "msavi2": 0.12432366609573364,
            "msi": 0.28854900598526,
        },
        "2018-11-06": {
            "ndwi1": 0.44795137643814087,
            "ndwi2": 0.21473655104637146,
            "nmdi": 0.0,
            "ndmi": 0.6521338224411011,
            "ndvi": 0.30616235733032227,
            "wdrvi": 0.4955117106437683,
            "evi": 0.9332512021064758,
            "msavi2": 0.24158185720443726,
            "msi": 0.573387086391449,
        },
        "2019-03-31": {
            "ndwi1": 0.7967597246170044,
            "ndwi2": 0.45317649841308594,
            "nmdi": 0.31483328342437744,
            "ndmi": 0.9255130290985107,
            "ndvi": 0.5568127632141113,
            "wdrvi": 0.7252984046936035,
            "evi": 0.841403067111969,
            "msavi2": 0.48653334379196167,
            "msi": 0.9474771618843079,
        },
        "2019-06-09": {
            "ndwi1": 0.030690312385559082,
            "ndwi2": 0.08242528140544891,
            "nmdi": 0.5143307447433472,
            "ndmi": 0.0062136054039001465,
            "ndvi": 0.01812279224395752,
            "wdrvi": 0.08645707368850708,
            "evi": 0.17904382944107056,
            "msavi2": 0.01259380578994751,
            "msi": 0.01661413535475731,
        },
        "2019-08-28": {
            "ndwi1": 0.19829463958740234,
            "ndwi2": 0.17398762702941895,
            "nmdi": 0.1956133097410202,
            "ndmi": 0.3603787422180176,
            "ndvi": 0.12881410121917725,
            "wdrvi": 0.2533041834831238,
            "evi": 0.11586672067642212,
            "msavi2": 0.10953480005264282,
            "msi": 0.27370110154151917,
        },
        "2019-10-27": {
            "ndwi1": 0.4539988040924072,
            "ndwi2": 0.20477204024791718,
            "nmdi": 0.12849724292755127,
            "ndmi": 0.6347531080245972,
            "ndvi": 0.2509358525276184,
            "wdrvi": 0.4236970543861389,
            "evi": 0.7389769554138184,
            "msavi2": 0.19917768239974976,
            "msi": 0.5650734305381775,
        },
        "2020-04-09": {
            "ndwi1": 0.6878429651260376,
            "ndwi2": 0.3810497522354126,
            "nmdi": 0.22532296180725098,
            "ndmi": 0.8178632855415344,
            "ndvi": 0.4952508211135864,
            "wdrvi": 0.6736660003662109,
            "evi": 0.9932594895362854,
            "msavi2": 0.423850953578949,
            "msi": 0.8255078196525574,
        },
        "2020-06-13": {
            "ndwi1": 0.0,
            "ndwi2": 0.07468287646770477,
            "nmdi": 0.450194776058197,
            "ndmi": 0.0,
            "ndvi": 0.0067313313484191895,
            "wdrvi": 0.09642159938812256,
            "evi": 0.10940712690353394,
            "msavi2": 0.0,
            "msi": 0.0,
        },
        "2020-08-22": {
            "ndwi1": 0.2067965865135193,
            "ndwi2": 0.09174137562513351,
            "nmdi": 0.1501033753156662,
            "ndmi": 0.36359965801239014,
            "ndvi": 0.08942735195159912,
            "wdrvi": 0.14109551906585693,
            "evi": 0.3752657175064087,
            "msavi2": 0.08344817161560059,
            "msi": 0.3045000433921814,
        },
        "2020-11-25": {
            "ndwi1": 0.43661463260650635,
            "ndwi2": 0.2930327355861664,
            "nmdi": 0.21047627925872803,
            "ndmi": 0.5352187752723694,
            "ndvi": 0.3742724657058716,
            "wdrvi": 0.5516014099121094,
            "evi": 0.946454644203186,
            "msavi2": 0.30478358268737793,
            "msi": 0.5076513290405273,
        },
        "2021-04-09": {
            "ndwi1": 0.6737490892410278,
            "ndwi2": 0.4431964159011841,
            "nmdi": 0.41444072127342224,
            "ndmi": 0.738451361656189,
            "ndvi": 0.5518730878829956,
            "wdrvi": 0.7286064624786377,
            "evi": 0.9143909811973572,
            "msavi2": 0.4749945402145386,
            "msi": 0.7633112072944641,
        },
        "2021-06-18": {
            "ndwi1": 0.033247530460357666,
            "ndwi2": 0.06682192534208298,
            "nmdi": 0.5221731066703796,
            "ndmi": 0.005461335182189941,
            "ndvi": 0.028204262256622314,
            "wdrvi": 0.08728432655334473,
            "evi": 0.23206794261932373,
            "msavi2": 0.02178746461868286,
            "msi": 0.022785665467381477,
        },
        "2021-09-06": {
            "ndwi1": 0.08259350061416626,
            "ndwi2": 0.0,
            "nmdi": 0.38892653584480286,
            "ndmi": 0.08634829521179199,
            "ndvi": 0.0,
            "wdrvi": 0.0,
            "evi": 0.340074360370636,
            "msavi2": 0.0018805265426635742,
            "msi": 0.1331336796283722,
        },
        "2021-10-31": {
            "ndwi1": 0.43528276681900024,
            "ndwi2": 0.17011721432209015,
            "nmdi": 0.10059604793787003,
            "ndmi": 0.6168769598007202,
            "ndvi": 0.29894906282424927,
            "wdrvi": 0.44318485260009766,
            "evi": 1.0,
            "msavi2": 0.24282938241958618,
            "msi": 0.5582749247550964,
        },
        "2022-03-25": {
            "ndwi1": 1.0,
            "ndwi2": 1.0,
            "nmdi": 0.9990663528442383,
            "ndmi": 1.0,
            "ndvi": 1.0,
            "wdrvi": 1.0,
            "evi": 0.911522388458252,
            "msavi2": 1.0,
            "msi": 1.0,
        },
        "2022-06-03": {
            "ndwi1": 0.3997379541397095,
            "ndwi2": 0.5511748194694519,
            "nmdi": 0.9655259847640991,
            "ndmi": 0.2512349486351013,
            "ndvi": 0.4851125478744507,
            "wdrvi": 0.7075703144073486,
            "evi": 0.0,
            "msavi2": 0.40160995721817017,
            "msi": 0.23140396177768707,
        },
        "2022-08-27": {
            "ndwi1": 0.5355101823806763,
            "ndwi2": 0.6881619095802307,
            "nmdi": 0.6831251382827759,
            "ndmi": 0.5452176928520203,
            "ndvi": 0.6225427389144897,
            "wdrvi": 0.8050597906112671,
            "evi": 0.17056047916412354,
            "msavi2": 0.5431762933731079,
            "msi": 0.44588980078697205,
        },
        "2022-10-31": {
            "ndwi1": 0.7613797187805176,
            "ndwi2": 0.893666684627533,
            "nmdi": 0.7844546437263489,
            "ndmi": 0.7902014851570129,
            "ndvi": 0.8439857363700867,
            "wdrvi": 0.9300882816314697,
            "evi": 0.5677812099456787,
            "msavi2": 0.7944258451461792,
            "msi": 0.6849935054779053,
        },
        "2023-04-23": {
            "ndwi1": 0.7428464889526367,
            "ndwi2": 0.8475736379623413,
            "nmdi": 0.9322012066841125,
            "ndmi": 0.689645528793335,
            "ndvi": 0.7833453416824341,
            "wdrvi": 0.8961102366447449,
            "evi": 0.39205020666122437,
            "msavi2": 0.7252813577651978,
            "msi": 0.6380822658538818,
        },
        "2023-06-03": {
            "ndwi1": 0.3839672803878784,
            "ndwi2": 0.5733916163444519,
            "nmdi": 1.0,
            "ndmi": 0.21109992265701294,
            "ndvi": 0.4988188147544861,
            "wdrvi": 0.7175832986831665,
            "evi": 0.10624593496322632,
            "msavi2": 0.41477417945861816,
            "msi": 0.20411477982997894,
        },
    }

    return pd.DataFrame.from_dict(data, orient="index")


def get_normalized_means_before_after():
    data = get_means_normalized()
    before_after = []
    for index in data.keys():
        before = []
        after = []
        for date, row in data[index].iteritems():
            date = dt.datetime.strptime(date, "%Y-%m-%d")
            if date.month in [8, 9]:
                boundary = dt.datetime.strptime("2022-01-01", "%Y-%m-%d")
                if date >= boundary:
                    after.append(row)
                else:
                    before.append(row)
        before_after.append(
            {
                "Index": index,
                "Date": "2 - After 2022-01",
                "Average Index Value": sum(after) / len(after),
            }
        )
        before_after.append(
            {
                "Index": index,
                "Date": "1 - Before 2022-01",
                "Average Index Value": sum(before) / len(before),
            }
        )
    # pd.DataFrame(before_after).to_excel(Path(r"C:\Users\jas\malopolska-drought-app\period3.xlsx"))
    return pd.DataFrame(before_after)


def get_normalized_means_periods():
    data = get_means_normalized()
    periods = []
    for index in data.keys():
        p1 = []
        p2 = []
        p3 = []
        p4 = []
        for date, row in data[index].iteritems():
            date = dt.datetime.strptime(date, "%Y-%m-%d")
            if date.month in [3, 4]:
                p1.append(row)
            if date.month in [6]:
                p2.append(row)
            if date.month in [8, 9]:
                p3.append(row)
            if date.month in [10, 11]:
                p4.append(row)
        periods.append(
            {"Index": index, "Period": "P1", "Average Index Value": sum(p1) / len(p1)}
        )
        periods.append(
            {"Index": index, "Period": "P2", "Average Index Value": sum(p2) / len(p2)}
        )
        periods.append(
            {"Index": index, "Period": "P3", "Average Index Value": sum(p3) / len(p3)}
        )
        periods.append(
            {"Index": index, "Period": "P4", "Average Index Value": sum(p4) / len(p4)}
        )
    # pd.DataFrame(before_after).to_excel(Path(r"C:\Users\jas\malopolska-drought-app\period3.xlsx"))
    return pd.DataFrame(periods)
